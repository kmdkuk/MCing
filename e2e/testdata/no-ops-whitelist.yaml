apiVersion: mcing.kmdkuk.com/v1alpha1
kind: Minecraft
metadata:
  name: ops-whitelist
spec:
  podTemplate:
    spec:
      containers:
        - name: minecraft
          image: itzg/minecraft-server:java21-alpine
          env:
            - name: TYPE
              value: "PURPUR"
            - name: EULA
              value: "true"

            # --- Lightweight world generation (Superflat, no structures) ---
            - name: LEVEL_TYPE
              value: "FLAT"
            - name: GENERATE_STRUCTURES
              value: "false"

            # --- Disable spawn and processing ---
            - name: SPAWN_ANIMALS
              value: "false"
            - name: SPAWN_MONSTERS
              value: "false"
            - name: SPAWN_NPCS
              value: "false"
            - name: ENABLE_COMMAND_BLOCK
              value: "false"

            # --- Minimize rendering and calculation load ---
            - name: VIEW_DISTANCE
              value: "3"
            - name: SIMULATION_DISTANCE
              value: "3"
            - name: MAX_PLAYERS
              value: "1"

            # --- JVM and GC optimization (SerialGC) ---
            - name: USE_AIKAR_FLAGS
              value: "false"
            - name: JVM_XX_OPTS
              value: "-XX:+UseSerialGC -Xss256k"

            # --- Other ---
            - name: ENABLE_STATUS_IMAGE
              value: "false"
  serviceTemplate:
    spec:
      type: NodePort
  volumeClaimTemplates:
    - metadata:
        name: minecraft-data
      spec:
        accessModes: ["ReadWriteOnce"]
        storageClassName: standard
        resources:
          requests:
            storage: 1Gi
